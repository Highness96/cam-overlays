<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Tip Goal Overlay</title>
<style>
  :root{
    --text: #ffffff;
    --shadow: rgba(0,0,0,0.85);
    --track: rgba(20,20,20,0.65);
    --fill: #00d8ff;
    --glow: rgba(0,216,255,0.85);
  }

  html, body {
    margin: 0;
    padding: 0;
    background: transparent;
    overflow: hidden;
    font-family: Arial, sans-serif;
    color: var(--text);
  }

  /* POSITION: top-left */
  #container {
    position: absolute;
    top: 20px;
    left: 20px;
    width: 650px;
    pointer-events: none;
  }

  /* Header row (title left, counter right) */
  #header {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: 16px;
    margin-bottom: 8px;
  }

  #title {
    font-size: 26px;
    font-weight: 800;
    text-shadow: 2px 2px 6px var(--shadow);
    white-space: nowrap;
  }

  #counter {
    font-size: 22px;
    font-weight: 800;
    text-shadow: 2px 2px 6px var(--shadow);
    white-space: nowrap;
    opacity: 0.95;
  }

  #progressContainer {
    position: relative;
    width: 100%;
    height: 18px;
    background: var(--track);
    border-radius: 999px;
    overflow: hidden;
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
  }

  #progressBar {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, rgba(0,216,255,0.9), rgba(0,216,255,0.55));
    border-radius: 999px;
    transition: width 450ms ease;
  }

  /* Glow animation on tip */
  @keyframes tipGlow {
    0%   { filter: drop-shadow(0 0 0 rgba(0,0,0,0)); }
    35%  { filter: drop-shadow(0 0 14px var(--glow)); }
    100% { filter: drop-shadow(0 0 0 rgba(0,0,0,0)); }
  }

  .glow {
    animation: tipGlow 900ms ease-out;
  }
</style>
</head>
<body>
  <div id="container">
    <div id="header">
      <div id="title">Tip Goal: <span id="targetText">50000</span> tokens</div>
      <div id="counter"><span id="currentText">0</span> / <span id="targetText2">50000</span></div>
    </div>

    <div id="progressContainer">
      <div id="progressBar"></div>
    </div>
  </div>

<script>
  // ===== SETTINGS =====
  const TARGET = 50000;   // <-- change this to whatever your goal is
  // ====================

  const container = document.getElementById("container");
  const currentText = document.getElementById("currentText");
  const targetText = document.getElementById("targetText");
  const targetText2 = document.getElementById("targetText2");
  const bar = document.getElementById("progressBar");

  targetText.textContent = TARGET;
  targetText2.textContent = TARGET;

  let current = 0;

  function render() {
    const pct = Math.max(0, Math.min(100, (current / TARGET) * 100));
    bar.style.width = pct + "%";
    currentText.textContent = current;
  }

  function glow() {
    container.classList.remove("glow");
    // force reflow so it re-triggers every time
    void container.offsetWidth;
    container.classList.add("glow");
  }

  window.addEventListener("message", (event) => {
    const data = event.data || {};
    if (data.type === "tip") {
      const amt = Number(data.amount) || 0;
      if (amt <= 0) return;

      current = Math.min(TARGET, current + amt);
      render();
      glow();
    }
  });

  render();
</script>
</body>
</html>
